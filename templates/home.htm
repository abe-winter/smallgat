{% extends "base.htm" %}
{% block title %}home{% endblock %}
{% block container %}
<h3>Your info</h3>
<div id="edit-app">
  {% if incomplete %}
  <div class="alert alert-danger">Your account is incomplete. You can't join groups until you populate all the fields</div>
  {% endif %}
  <table id="edit-app">
    <tr>
      <th>Email</th>
      <td>{{email}}</td>
    </tr>
    <tr>
      <th>Name</th>
      <td>{{name or ''}}</td>
    </tr>
    <tr>
      <th>Age</th>
      <td>{{age or ''}}</td>
    </tr>
    <tr>
      <th>Address</th>
      <td>{{address or ''}}</td>
    </tr>
  </table>
</div>
<hr>
{% if institutions %}
<h3>Your institutions</h3>
<hr>
{% endif %}
<h3>Your groups</h3>
<p>Groups are ...</p>
{% if not groups %}
<div class="alert alert-warning">You don't have any groups yet. </div>
{% else %}
{% endif %}
<hr>
<details>
  <summary>Advanced controls</summary>
  <a class="btn btn-success" href="#">Create an institution</a>
  <br>
  <br>
  <form action="{{url_for('user.delete_me')}}" method="post">
    <button class="btn btn-danger" role="submit">Delete user</button>
  </form>
</details>
<script src="https://cdn.jsdelivr.net/npm/vue"></script>
<script type="text/javascript">
Vue.component('required', {
  props: ['val'],
  {% raw %}
  template: `<span v-if="val">{{val}}</span>
  <span v-else style="color: red">required</span>`
  {% endraw %}
});

const VUE = new Vue({
  el: '#edit-app',
  data: () => ({
    email: {{email|tojson}},
    name: {{name|tojson}},
    age: {{age|tojson}},
    address: {{address|tojson}},
  }),
  computed: {
    incomplete() {
      return !(this.name && this.age && this.address);
    },
  },
  {% raw %}
  template: `<div>
  <div v-if="incomplete" class="alert alert-danger">Your account is incomplete. You can't join groups until you populate all the fields</div>
    <table>
      <tr>
        <th>Email</th>
        <td>{{email}}</td>
      </tr>
      <tr>
        <th>Name</th>
        <td><required :val="name" /></td>
      </tr>
      <tr>
        <th>Age</th>
        <td><required :val="age" /></td>
      </tr>
      <tr>
        <th>Address</th>
        <td><required :val="address" /></td>
      </tr>
    </table>
  </div>`,
  {% endraw %}
});
</script>
{% endblock container %}
